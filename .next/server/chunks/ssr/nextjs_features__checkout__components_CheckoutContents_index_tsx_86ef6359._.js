module.exports=[33122,a=>{"use strict";var b=a.i(90767),c=a.i(50788),d=a.i(65797),e=a.i(73852);let f=["jnt","jne","tiki","pos","ninja","sicepat"],g={jne:"JNE",jnt:"J&T Express",tiki:"TIKI",ninja:"Ninja Express",pos:"POS Indonesia",sicepat:"SiCepat"};var h=a.i(36738);let i=h.z.object({destination:h.z.number().min(1,"Shipping destination is required"),weight:h.z.number().min(1,"Product weight is required"),courier:h.z.enum(f,"Please select a courier")});var j=a.i(82742),k=a.i(56228),l=a.i(77729),m=a.i(51545);let n=(0,l.memo)(({courier:a,selectedCourier:c,onClick:d})=>{let f=c?.code===a.code&&c?.service===a.service;return console.log("ðŸš€ ~ CourierCardItem ~ isSelected:",f),(0,b.jsx)(e.Card,{onClick:d,className:(0,j.cn)("cursor-pointer rounded-sm p-0 text-sm",f&&"border-baraka-primary-300 border"),children:(0,b.jsxs)(e.CardContent,{className:"w-full p-2",children:[(0,b.jsx)(e.CardHeader,{className:"mb-2 h-fit border-b px-0 [.border-b]:pb-2",children:(0,b.jsx)(e.CardTitle,{className:"",children:(0,b.jsx)("h3",{className:"font-medium",children:a.name})})}),(0,b.jsxs)("div",{className:"inline-flex w-full items-center justify-between",children:[(0,b.jsx)("p",{className:"font-medium text-zinc-500",children:"Service : "}),(0,b.jsx)("p",{className:"font-bold",children:a.service})]}),(0,b.jsxs)("div",{className:"inline-flex w-full items-center justify-between",children:[(0,b.jsx)("p",{className:"font-medium text-zinc-500",children:"Description : "}),(0,b.jsx)("p",{className:"font-bold",children:a.description})]}),(0,b.jsxs)("div",{className:"inline-flex w-full items-center justify-between",children:[(0,b.jsx)("p",{className:"font-medium text-zinc-500",children:"Estimated Time : "}),(0,b.jsx)("p",{className:"font-bold",children:a.etd})]}),(0,b.jsxs)(e.CardFooter,{className:"mt-5 inline-flex w-full items-center justify-between border-t px-2 [.border-t]:pt-2",children:[(0,b.jsx)("p",{className:"font-medium text-zinc-400",children:"COST"}),(0,b.jsx)("p",{className:"font-bold",children:(0,j.moneyFormatter)(a.cost)})]})]})})});function o(){return(0,b.jsx)("section",{className:"mt-10 text-center text-red-500",children:(0,b.jsxs)("h2",{children:["The courier you selected is currently unavailable.",(0,b.jsx)("br",{}),"Please select another one."]})})}let p=(0,l.memo)(({data:a,selectedCourier:c,onSelectedCourier:d})=>void 0===a?null:a?.length?(0,b.jsx)("section",{className:"mt-10 grid grid-cols-1 gap-4 sm:grid-cols-2",children:a.map((a,e)=>(0,b.jsx)(n,{courier:a,selectedCourier:c,onClick:()=>{d({courier:a.code,service:a.service,cost:a.cost,etd:a.etd})}},e))}):(0,b.jsx)(o,{}));var q=a.i(52424),r=a.i(10014),s=a.i(51247),t=a.i(8776),u=a.i(70414);let v=({onSubmit:a,isLoading:c,control:d})=>(0,b.jsxs)("form",{onSubmit:a,className:"inline-flex w-full flex-col items-center gap-4",children:[(0,b.jsxs)("section",{className:"w-full space-y-4",children:[(0,b.jsx)(s.Label,{children:"Courier"}),(0,b.jsx)(m.Controller,{control:d,name:"courier",render:({field:a})=>(0,b.jsxs)(t.Select,{value:a.value??"",onValueChange:a.onChange,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-full",children:(0,b.jsx)(t.SelectValue,{placeholder:"Courier"})}),(0,b.jsx)(t.SelectContent,{children:f.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:g[a]},a))})]})})]}),(0,b.jsx)(r.Button,{disabled:c,type:"submit",className:(0,j.cn)("mx-auto w-1/2",c&&"animate-pulse cursor-wait"),children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(u.Loader2,{className:"animate-spin"}),"Loading..."]}):"CHECK COURIER"})]}),w=({address:a,checkoutSummary:c,mutateSetShipping:d,mutateCekOngkir:f})=>{let{data:g,isPending:h}=f,n=h||d.isPending,{handleSubmit:o,control:r,setValue:s,formState:{errors:t}}=(0,m.useForm)({resolver:(0,k.zodResolver)(i)}),u=g?.data;(0,l.useEffect)(()=>{c&&a&&(s("destination",a.subdistrict_id),s("weight",c?.total_items_weight??0),c.shipping&&s("courier",c.shipping.courier,{shouldDirty:!1,shouldTouch:!1}))},[c,s,a]),(0,l.useEffect)(()=>{c?.shipping&&a&&f.mutate({courier:c.shipping.courier,destination:a.subdistrict_id,weight:c?.total_items_weight??0})},[c?.shipping,a,c?.total_items_weight]);let w=(0,l.useCallback)(a=>{d.mutate(a)},[d]),x=(0,l.useMemo)(()=>{if(!c?.shipping)return;let{courier:a,service:b}=c.shipping;return{code:a,service:b}},[c?.shipping]),y=(0,l.useCallback)(a=>{f.mutate(a)},[f]);return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(e.Card,{className:(0,j.cn)("relative",t.courier&&"border-red-500"),children:[t.courier&&(0,b.jsx)(q.default,{message:t.courier?.message,iconable:!0,size:"lg",variant:"error",className:"absolute top-2 right-2"}),(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Shipping calculation"})}),(0,b.jsxs)(e.CardContent,{className:"w-full",children:[(0,b.jsx)(v,{control:r,onSubmit:o(y),isLoading:n}),(0,b.jsx)(p,{data:u,selectedCourier:x,onSelectedCourier:w})]})]})})};var x=a.i(9981),y=a.i(9895),z=a.i(83231);let A=()=>(0,b.jsxs)(e.Card,{className:"sticky top-20 bottom-0 w-full min-w-xs md:w-1/2",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{className:"size-8 w-30 animate-pulse rounded-md bg-zinc-300"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"space-y-5",children:(0,b.jsx)("div",{className:"pb-2",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"size-8 w-56 animate-pulse rounded-md bg-zinc-300"}),(0,b.jsxs)("div",{className:"mt-3 inline-flex items-center gap-2 text-xs",children:[(0,b.jsx)("div",{className:"size-6 animate-pulse rounded-md bg-zinc-300"}),(0,b.jsx)("div",{className:"size-6 w-20 animate-pulse rounded-md bg-zinc-300"})]})]}),(0,b.jsx)("div",{className:"size-8 w-46 animate-pulse rounded-md bg-zinc-300"})]})})}),(0,b.jsxs)("div",{className:"mt-10 space-y-1",children:[(0,b.jsxs)("div",{className:"inline-flex w-full items-start justify-between",children:[(0,b.jsx)("div",{className:"size-8 w-30 animate-pulse rounded-md bg-zinc-300"}),(0,b.jsx)("div",{className:"size-8 w-30 animate-pulse rounded-md bg-zinc-300"})]}),(0,b.jsxs)("div",{className:"inline-flex w-full items-start justify-between",children:[(0,b.jsx)("div",{className:"size-8 w-30 animate-pulse rounded-md bg-zinc-300"}),(0,b.jsx)("div",{className:"size-8 w-20 animate-pulse rounded-md bg-zinc-300"})]}),(0,b.jsxs)("div",{className:"inline-flex w-full items-start justify-between",children:[(0,b.jsx)("div",{className:"size-8 w-20 animate-pulse rounded-md bg-zinc-300"}),(0,b.jsx)("div",{className:"size-8 w-10 animate-pulse rounded-md bg-zinc-300"})]})]}),(0,b.jsx)("div",{className:"size-8 w-full rounded-md bg-zinc-300"})]})})]}),B=({addressId:a,summary:c,createTransaction:d,isCreating:f,isLoadingSummary:g})=>{let{initiatePayment:h,isProcessing:i}=(0,y.default)(),k=c?.shipping,l=async()=>{if(!a)return Error("Please set your primary address.");try{let{snap_token:b,order_id:c}=(await d(a)).data;if(!b)return Error("Missing snap token");await h(b,c)}catch(a){console.error("ðŸš€ ~ handlePay ~ err:",a),z.toast.error("Failed to make a payment. Please try again.",{position:"top-right"})}},m=!k||f||i;return g?(0,b.jsx)(A,{}):c&&c?.items.length?(0,b.jsxs)(e.Card,{className:"sticky top-20 bottom-0 w-full min-w-xs md:w-1/2",children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Billing details"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsxs)("section",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"space-y-2",children:c&&c.items.map(a=>(0,b.jsx)("div",{className:"border-b pb-2 uppercase",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"",children:[(0,b.jsx)("p",{children:a.name}),(0,b.jsxs)("div",{className:"inline-flex items-center gap-2 text-xs",children:[(0,b.jsx)("div",{style:{backgroundColor:a.variant.color},className:"size-3 rounded-full"}),(0,b.jsx)("span",{children:"/"}),(0,b.jsx)("p",{children:a.size})]})]}),(0,b.jsxs)("p",{children:[(0,j.moneyFormatter)(a.price)," ",(0,b.jsxs)("b",{children:["x ",a.quantity]})]})]})},a.product_variant_option_id))}),(0,b.jsxs)("div",{className:"mt-10 space-y-1",children:[(0,b.jsxs)("div",{className:"inline-flex w-full items-start justify-between",children:[(0,b.jsx)("p",{className:"font-bold text-zinc-500",children:"SUBTOTAL : "}),(0,b.jsx)("p",{className:"font-bold",children:(0,j.moneyFormatter)(c?.items_total)})]}),(0,b.jsxs)("div",{className:"inline-flex w-full items-start justify-between",children:[(0,b.jsx)("p",{className:"font-bold text-zinc-500",children:"SHIPPING COST : "}),(0,b.jsx)("p",{className:(0,j.cn)("font-bold",!k&&"rounded bg-red-200 px-2 font-normal text-red-500"),children:k?(0,j.moneyFormatter)(c?.shipping_cost):"Please Select a Courier First."})]}),(0,b.jsxs)("div",{className:"inline-flex w-full items-start justify-between",children:[(0,b.jsx)("p",{className:"font-bold",children:"TOTAL PAYMENT : "}),(0,b.jsx)("p",{className:(0,j.cn)("font-bold"),children:(0,j.moneyFormatter)(c?.grand_total)})]})]}),(0,b.jsxs)(r.Button,{onClick:l,disabled:m,className:(0,j.cn)("bg-baraka-primary-300 hover:bg-baraka-lightgreen-200 mt-5 w-full cursor-pointer text-lg font-bold uppercase",m&&"cursor-not-allowed opacity-50"),children:[f||i&&(0,b.jsx)(u.Loader2,{strokeWidth:1,className:"animate-spin text-white"}),f?"Preparing payment...":i?"Processing payment...":"PAY NOW"]})]})})]}):null};var C=a.i(30579);let D=(0,d.default)(()=>a.A(2419),{loadableGenerated:{modules:[52496]}});function E(){let{userPrimaryAddress:{data:a,isLoading:d}}=(0,c.default)(),{checkoutSummary:e,isLoadingSummary:f,mutateCheckoutTransaction:{mutateAsync:g,isPending:h},mutateSetShipping:i}=(0,x.default)({isCheckoutPage:!0}),{mutateCekOngkir:j}=(0,C.default)(),k=a?.data;return(0,b.jsxs)("section",{className:"relative mt-10 flex w-full flex-col items-start justify-between gap-5 md:flex-row",children:[(0,b.jsxs)("section",{className:"w-full min-w-xs space-y-5 md:w-2/3",children:[(0,b.jsx)(D,{address:k,isLoading:d}),(0,b.jsx)(w,{address:k,checkoutSummary:e,mutateSetShipping:i,mutateCekOngkir:j})]}),(0,b.jsx)(B,{addressId:k?.id,summary:e,createTransaction:g,isCreating:h,isLoadingSummary:f})]})}a.s(["default",()=>E],33122)}];

//# sourceMappingURL=nextjs_features__checkout__components_CheckoutContents_index_tsx_86ef6359._.js.map